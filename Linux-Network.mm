<map version="1.0.1">
<!-- To view this file, download free mind mapping software FreeMind from http://freemind.sourceforge.net -->
<node CREATED="1471793677782" ID="ID_1892904658" MODIFIED="1471793706296" TEXT="Linux-Network">
<node CREATED="1471793733432" ID="ID_1354343180" MODIFIED="1471793746350" POSITION="right" TEXT="linux&#x7f51;&#x7edc;&#x914d;&#x7f6e;&#x7684;&#x77e5;&#x8bc6;">
<node CREATED="1471793752591" ID="ID_1111387291" MODIFIED="1474009884624" TEXT="1.iptables&#x7684;&#x77e5;&#x8bc6;">
<node CREATED="1471794356866" ID="ID_225341980" MODIFIED="1471794599244">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      iptables&#21482;&#26159;&#29992;&#26469;&#35774;&#32622;&#38450;&#28779;&#22681;&#30340;&#35268;&#21017;&#30340;&#65292;&#30495;&#27491;&#22312;
    </p>
    <p>
      &#20869;&#26680;&#24403;&#20013;&#35835;&#21462;&#35268;&#21017;&#24182;&#19988;&#21152;&#20197;&#25191;&#34892;&#30340;&#26159;netfilter,
    </p>
    <p>
      &#22312;&#20869;&#26680;&#24403;&#20013;&#65292;&#20849;&#26377;&#20116;&#20010;&#20301;&#32622;&#21487;&#20197;&#35753;netfilter&#21457;&#25381;&#20316;&#29992;
    </p>
    <p>
      <font color="#0e8044"><i>1.&#20174;&#19968;&#20010;&#32593;&#32476;&#25509;&#21475;&#36827;&#26469;&#21040;&#21478;&#19968;&#20010;&#32593;&#32476;&#25509;&#21475;&#21435;&#30340; </i></font>
    </p>
    <p>
      <font color="#0e8044"><i>2.&#25968;&#25454;&#21253;&#20174;&#20869;&#26680;&#27969;&#20837;&#21040;&#29992;&#25143;&#31354;&#38388;&#30340; </i></font>
    </p>
    <p>
      <font color="#0e8044"><i>3.&#25968;&#25454;&#21253;&#20174;&#29992;&#25143;&#31354;&#38388;&#27969;&#20986;&#30340; </i></font>
    </p>
    <p>
      <font color="#0e8044"><i>4.&#36827;&#20837;/&#31163;&#24320;&#26412;&#26426;&#30340;&#22806;&#32593;&#25509;&#21475; </i></font>
    </p>
    <p>
      <font color="#0e8044"><i>5.&#36827;&#20837;/&#31163;&#24320;&#26412;&#26426;&#30340;&#20869;&#32593;&#25509;&#21475;</i></font>
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1471962187162" ID="ID_348199352" MODIFIED="1471962199436" TEXT="NAT&#x8f6c;&#x6362;">
<font BOLD="true" NAME="SansSerif" SIZE="14"/>
</node>
<node CREATED="1472135080422" ID="ID_1423536812" MODIFIED="1474009888891" TEXT="&#x7cfb;&#x7edf;&#x9884;&#x5148;&#x5b9a;&#x4e49;&#x7684;&#x4e94;&#x4e2a;chain">
<node CREATED="1472135097565" ID="ID_229338706" MODIFIED="1472135158258">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b>PREROUTING</b>
    </p>
    <p>
      &#22312;&#36335;&#30001;&#20915;&#31574;&#34987;&#20570;&#20986;&#20043;&#21069;&#65292;&#25968;&#25454;&#21253;&#23558;&#20250;&#36827;&#20837;
    </p>
    <p>
      &#35813;chain&#36827;&#34892;&#22788;&#29702;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1472135260669" ID="ID_427684341" MODIFIED="1472135376136">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b>INPUT</b>
    </p>
    <p>
      &#25968;&#25454;&#21253;&#23558;&#20250;&#34987;&#22312;&#26412;&#22320;&#36827;&#34892;&#20132;&#20184;
    </p>
    <p>
      &#26412;&#22320;&#20132;&#20184;&#30001;'local-delivery'&#36335;&#30001;&#34920;&#36827;&#34892;&#25511;&#21046;
    </p>
    <p>
      ip route show table local
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1472135400180" ID="ID_813076884" MODIFIED="1472135456322">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b>FORWARD</b>
    </p>
    <p>
      &#25152;&#26377;&#24050;&#32463;&#23436;&#25104;&#36335;&#30001;&#20915;&#31574;&#24182;&#19988;&#19981;&#20250;&#34987;&#26412;&#22320;&#20132;&#20184;
    </p>
    <p>
      &#30340;&#25968;&#25454;&#21253;&#23558;&#20250;&#22312;&#35813;chain&#19978;&#36827;&#34892;&#22788;&#29702;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1472135497572" ID="ID_564673582" MODIFIED="1472135528544">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b>OUTPUT</b>
    </p>
    <p>
      &#30001;&#26426;&#22120;&#26412;&#36523;&#21457;&#20986;&#30340;&#25968;&#25454;&#21253;&#23558;&#20250;&#32463;&#36807;
    </p>
    <p>
      &#35813;chain&#30340;&#22788;&#29702;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1472135557059" ID="ID_1342547305" MODIFIED="1472135610915">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b>POSTROUTING</b>
    </p>
    <p>
      &#36335;&#30001;&#20915;&#31574;&#24050;&#32463;&#20570;&#20986;&#65292;&#25968;&#25454;&#21253;&#22312;&#34987;&#20132;&#20184;&#21040;
    </p>
    <p>
      &#30828;&#20214;&#20043;&#21069;&#20250;&#32463;&#36807;&#35813;chain&#30340;&#22788;&#29702;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1471797713540" FOLDED="true" ID="ID_1122464452" MODIFIED="1474008335347" TEXT="2.route&#x547d;&#x4ee4;&#x7684;&#x8f93;&#x51fa;&#x4fe1;&#x606f;">
<node CREATED="1471797751844" ID="ID_1523668766" MODIFIED="1471879616669">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Destination:&#30446;&#26631;&#32593;&#32476;&#25110;&#32773;&#26159;&#30446;&#26631;&#20027;&#26426;
    </p>
    <p>
      Gateway:&#32593;&#20851;&#22320;&#22336;&#65292;&#22914;&#26524;&#26159;*&#21017;&#20195;&#34920;&#27809;&#26377;&#36827;&#34892;&#35774;&#32622;
    </p>
    <p>
      Genmask:&#30446;&#26631;&#32593;&#32476;&#30340;&#32593;&#32476;&#25513;&#30721;255.255.255.255&#29992;&#20110;&#30446;&#26631;&#20027;&#26426;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;0.0.0.0&#29992;&#20110;&#40664;&#35748;&#30340;&#36335;&#30001;
    </p>
    <p>
      Flag:
    </p>
    <p>
      U---&gt; route is up
    </p>
    <p>
      H---&gt;&#20195;&#34920;&#30446;&#26631;&#26159;&#19968;&#20010;host
    </p>
    <p>
      G---&gt;use gateway
    </p>
    <p>
      R (reinstate route for dynamic routing)
    </p>
    <p>
      D (dynamically installed by daemon or redirect)
    </p>
    <p>
      M (modified from routing daemon or redirect)
    </p>
    <p>
      A (installed by addrconf)
    </p>
    <p>
      C (cache entry)
    </p>
    <p>
      !&#160;&#160;(reject route)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1471879687118" ID="ID_1747051872" MODIFIED="1471879705008" TEXT="Metric:&#x5230;&#x76ee;&#x6807;&#x7684;&#x8ddd;&#x79bb;&#xff0c;&#x4ee5;hop&#x4f5c;&#x4e3a;&#x8ba1;&#x7b97;"/>
<node CREATED="1471879754782" ID="ID_1185169255" MODIFIED="1471879790624" TEXT="Ref:&#x5230;&#x8be5;&#x8def;&#x7531;&#x7684;&#x5f15;&#x7528;&#x6570;&#x76ee;"/>
<node CREATED="1471882936648" ID="ID_538088504" MODIFIED="1471882962134" TEXT="Use:&#x67e5;&#x627e;&#x8be5;&#x8def;&#x7531;&#x7684;&#x8ba1;&#x6570;"/>
<node CREATED="1471883016310" ID="ID_207422001" MODIFIED="1471883039787" TEXT="Iface:&#x5bf9;&#x5e94;&#x4e8e;&#x8be5;&#x8def;&#x7531;&#x7684;&#x6570;&#x636e;&#x5305;&#x5c06;&#x88ab;&#x9001;&#x5165;&#x7684;&#x63a5;&#x53e3;"/>
<node CREATED="1471883190982" ID="ID_440037647" MODIFIED="1471883224889" TEXT="MSS:&#x5728;&#x8be5;&#x8def;&#x7531;&#x4e0a;&#x7684;&#x6700;&#x5927;&#x7684;tcp&#x6570;&#x636e;&#x6bb5;&#x5927;&#x5c0f;"/>
</node>
</node>
<node CREATED="1474008369389" ID="ID_1959499381" MODIFIED="1474008403947" POSITION="left">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#c70707"><i>http://www.netfilter.org/documentation/HOWTO </i></font>
    </p>
    <p>
      <font color="#c70707"><i>&#32593;&#31449;howto&#25991;&#26723;&#30340;&#23398;&#20064;</i></font>
    </p>
  </body>
</html>
</richcontent>
<node CREATED="1474008465445" ID="ID_1421441449" MODIFIED="1474008481808">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1.Packet Filter
    </p>
  </body>
</html>
</richcontent>
<node CREATED="1474008825185" ID="ID_637676182" MODIFIED="1474009223007">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <i>1.&#22914;&#20309;&#36827;&#34892;&#21253;&#36807;&#28388;</i>
    </p>
    <p>
      linux kernel&#20174;1.1&#29256;&#26412;&#24320;&#22987;&#23601;&#25317;&#26377;&#20102;&#21253;&#36807;&#28388;&#30340;&#21151;&#33021;
    </p>
    <p>
      &#31532;&#19968;&#20195;&#22522;&#20110;BSD&#31995;&#32479;&#30340;ipfw
    </p>
    <p>
      &#22312;linux2.0&#29256;&#26412;&#30340;&#26102;&#20505;ipfw&#34987;&#22686;&#24378;&#20102;,&#20986;&#29616;&#20102;&#29992;&#25143;&#31354;&#38388;
    </p>
    <p>
      &#30340;&#24037;&#20855;ipfwadm
    </p>
    <p>
      &#22312;linux2.2&#29256;&#26412;&#30340;&#26102;&#20505;&#20869;&#26680;&#34987;&#22823;&#37327;&#22320;&#37325;&#26500;&#20102;&#65292;&#24182;&#19988;&#20986;&#29616;
    </p>
    <p>
      &#20102;&#26032;&#30340;&#24037;&#20855;ipchains
    </p>
    <p>
      &#22312;linux2.4&#30340;&#26102;&#20505;&#65292;&#20869;&#26680;&#20877;&#19968;&#27425;&#34987;&#28145;&#24230;&#37325;&#26500;&#65292;&#24182;&#19988;&#24341;&#20837;&#20102;
    </p>
    <p>
      &#31532;&#22235;&#20195;&#30340;&#21253;&#36807;&#28388;&#24037;&#20855;iptables
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474009722379" ID="ID_1317665737" MODIFIED="1474009838137">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2.&#22522;&#26412;&#30340;&#25805;&#20316;&#31034;&#33539;
    </p>
    <p>
      Most people just have a single PPP connection to the Internet,
    </p>
    <p>
      and don't want anyone coming back into their network, or the firewall:
    </p>
    <p>
      
    </p>
    <p>
      <font color="#e70404"><i>## Insert connection-tracking modules (not needed if built into kernel). </i></font>
    </p>
    <p>
      <font color="#e70404"><i># insmod ip_conntrack </i></font>
    </p>
    <p>
      <font color="#e70404"><i># insmod ip_conntrack_ftp </i></font>
    </p>
    <p>
      
    </p>
    <p>
      <font color="#e70404"><i>## Create chain which blocks new connections, except if coming from inside. </i></font>
    </p>
    <p>
      <font color="#e70404"><i># iptables -N block </i></font>
    </p>
    <p>
      <font color="#e70404"><i># iptables -A block -m state --state ESTABLISHED,RELATED -j ACCEPT </i></font>
    </p>
    <p>
      <font color="#e70404"><i># iptables -A block -m state --state NEW -i ! ppp0 -j ACCEPT </i></font>
    </p>
    <p>
      <font color="#e70404"><i># iptables -A block -j DROP </i></font>
    </p>
    <p>
      
    </p>
    <p>
      <font color="#e70404"><i>## Jump to that chain from INPUT and FORWARD chains. </i></font>
    </p>
    <p>
      <font color="#e70404"><i># iptables -A INPUT -j block </i></font>
    </p>
    <p>
      <font color="#e70404"><i># iptables -A FORWARD -j block </i></font>
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474009928506" ID="ID_1235678704" MODIFIED="1474010559529">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3.&#21253;&#22914;&#20309;&#22312;filter&#24403;&#20013;&#36890;&#36807;
    </p>
    <p>
      &#22312;&#20869;&#26680;&#30340;filter&#34920;&#24403;&#20013;&#26377;&#19977;&#26465;&#35268;&#21017;&#21015;&#34920;&#65292;&#34987;&#25104;&#20026;
    </p>
    <p>
      INPUT OUTPUT FORWARD
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;_____
    </p>
    <p>
      Incoming&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Outgoing
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;--&gt;[Routing ]---&gt;|FORWARD|-------&gt;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;[Decision]&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;&#160;____&#160;&#160;&#160;&#160;&#160;_/&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;^
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;v&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;____
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;___&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/&#160;&#160;&#160;&#160;\
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/&#160;&#160;&#160;\&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|OUTPUT|
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|INPUT|&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\____/
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\___/&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;^
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;----&gt; Local Process ----
    </p>
  </body>
</html>
</richcontent>
<node CREATED="1474010571061" ID="ID_1125639619" MODIFIED="1474010870042">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#19968;&#20010;chain&#23601;&#26159;&#19968;&#20010;&#21253;&#35268;&#21017;&#30340;&#26816;&#26597;&#21015;&#34920;
    </p>
    <p>
      &#27599;&#20010;&#35268;&#21017;&#37117;&#20250;&#20915;&#23450;&#23545;&#35813;&#21253;&#36827;&#34892;&#24590;&#26679;&#30340;&#22788;&#29702;&#12290;
    </p>
    <p>
      &#22914;&#26524;&#24403;&#21069;&#30340;&#35268;&#21017;&#36319;&#35813;&#21253;&#19981;&#21305;&#37197;&#65292;&#37027;&#20040;&#21253;&#20250;&#34987;&#25552;&#20379;&#32473;
    </p>
    <p>
      &#21015;&#34920;&#37324;&#38754;&#30340;&#19979;&#19968;&#20010;&#35268;&#21017;&#36827;&#34892;&#21305;&#37197;&#25805;&#20316;&#65292;&#22914;&#26524;&#21015;&#34920;&#37324;&#38754;
    </p>
    <p>
      &#30340;&#25152;&#26377;&#30340;&#35268;&#21017;&#37117;&#19981;&#21305;&#37197;&#35813;&#21253;&#65292;&#37027;&#20040;&#20869;&#26680;&#20250;&#26597;&#25214;chain policy
    </p>
    <p>
      &#26469;&#20915;&#23450;&#37319;&#21462;&#20160;&#20040;&#26679;&#23376;&#30340;&#21160;&#20316;&#12290;
    </p>
  </body>
</html>
</richcontent>
</node>
</node>
<node CREATED="1474010884549" ID="ID_1193653942" MODIFIED="1474010916417">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#295922"><b>&#20351;&#29992;iptables</b></font>
    </p>
  </body>
</html>
</richcontent>
<node CREATED="1474011784900" ID="ID_760267047" MODIFIED="1474012097748">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#d51616"><i>1.&#21333;&#20010;&#35268;&#21017;&#19978;&#38754;&#30340;&#25805;&#20316;</i></font>
    </p>
    <p>
      &#27599;&#20010;&#35268;&#21017;&#25351;&#23450;&#20102;&#19968;&#31995;&#21015;&#21253;&#24517;&#39035;&#28385;&#36275;&#30340;&#26465;&#20214;&#65292;&#19968;&#26086;&#35813;&#26465;&#20214;
    </p>
    <p>
      &#28385;&#36275;&#65292;&#37027;&#20040;&#23558;&#20250;&#22914;&#20309;&#36827;&#34892;&#22788;&#29702;
    </p>
    <p>
      &#27604;&#22914;&#20320;&#24819;drop&#25152;&#26377;&#30340;&#26469;&#33258;&#20110;127.0.0.1&#22320;&#22336;&#30340;ICMP&#25253;&#25991;
    </p>
    <p>
      &#37027;&#20040;&#20320;&#21487;&#20197;&#20687;&#19979;&#38754;&#37027;&#26679;&#36827;&#34892;&#22788;&#29702;
    </p>
    <p>
      #iptables -A INPUT -s 127.0.0.1 -p icmp -j DROP
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474012213241" FOLDED="true" ID="ID_1423231817" MODIFIED="1474122011344">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#e11b11"><i><b>2.&#19968;&#20123;&#35814;&#32454;&#30340;&#25351;&#20196;&#25805;&#20316;</b></i></font>
    </p>
  </body>
</html>
</richcontent>
<node CREATED="1474012271105" ID="ID_1478621609" MODIFIED="1474013092685">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#a20711"><i>1.&#25351;&#23450;&#28304;&#21644;&#30446;&#30340;ip&#22320;&#22336;</i></font>
    </p>
    <p>
      <font color="#168149">&#28304;&#22320;&#22336;</font>&#21487;&#20197;&#20351;&#29992;-s --source --src&#25351;&#23450;
    </p>
    <p>
      <font color="#8c1111">&#30446;&#30340;&#22320;&#22336;</font>&#21487;&#20197;&#20351;&#29992;-d --destination --dst&#25351;&#23450;
    </p>
    <p>
      <font color="#bb0707">ip&#22320;&#22336;</font>&#21487;&#20197;&#36890;&#36807;&#22495;&#21517;&#25351;&#23450;&#65292;&#21487;&#20197;&#36890;&#36807;ip&#22320;&#22336;&#25351;&#23450;&#65292;
    </p>
    <p>
      &#20063;&#21487;&#20197;&#25351;&#23450;&#19968;&#32452;ip&#22320;&#22336;&#65292;&#27604;&#22914;&#19979;&#38754;&#30340;
    </p>
    <p>
      '199.95.207.0/24' or '199.95.207.0/255.255.255.0'
    </p>
    <p>
      &#22914;&#26524;&#25351;&#23450;&#20219;&#20309;&#22320;&#22336;&#65292;&#37027;&#20040;/0&#36873;&#39033;&#20250;&#34987;&#20351;&#29992;&#21040;
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474013156164" ID="ID_762562279" MODIFIED="1474013189601">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#eb1010"><i>2.&#25351;&#23450;&#21253;&#30340;&#21327;&#35758;</i></font>
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474013195162" ID="ID_1864571523" MODIFIED="1474014892186">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#dd0909"><i>3.&#25351;&#23450;&#19968;&#20010;&#25509;&#21475; </i></font>
    </p>
    <p>
      -i(--in-interface)&#25110;&#32773;-o(--out-interface)&#36873;&#39033;&#25351;&#23450;&#20102;
    </p>
    <p>
      &#21305;&#37197;&#30340;&#25509;&#21475;&#30340;&#21517;&#31216;&#12290;
    </p>
    <p>
      &#19968;&#20010;&#25509;&#21475;&#23601;&#26159;&#19968;&#20010;&#21253;&#36827;&#20837;&#25110;&#32773;&#20986;&#21435;&#30340;&#35774;&#22791;
    </p>
    <p>
      &#20026;&#19968;&#20010;&#35268;&#21017;&#25351;&#23450;&#19968;&#20010;&#24403;&#21069;&#24182;&#19981;&#23384;&#22312;&#30340;&#25509;&#21475;&#21517;&#31216;&#26159;&#21512;&#27861;&#30340;&#65292;&#24403;&#35813;
    </p>
    <p>
      &#25509;&#21475;&#35774;&#22791;&#21551;&#21160;&#30340;&#26102;&#20505;&#65292;&#35813;&#35268;&#21017;&#23601;&#20250;&#36215;&#20316;&#29992;&#20102;&#12290;
    </p>
    <p>
      <i>&#27880;&#24847;: &#22914;&#26524;&#22312;&#25509;&#21475;&#21517;&#31216;&#21518;&#38754;&#28155;&#21152;&#20102;&#19968;&#20010;'+'&#31526;&#21495;&#65292;&#37027;&#20040;&#25152;&#26377;&#20197;&#35813;&#25509;&#21475; </i>
    </p>
    <p>
      <i>&#21517;&#31216;&#20026;&#24320;&#22836;&#30340;&#25509;&#21475;&#37117;&#20250;&#34987;&#21305;&#37197;</i>
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474034419641" ID="ID_2838145" MODIFIED="1474034806854">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#c81212"><i>4.specifying fragment </i></font>
    </p>
    <p>
      &#26377;&#26102;&#20505;&#22312;&#32593;&#32476;&#20256;&#36755;&#30340;&#36807;&#31243;&#24403;&#20013;&#65292;&#19968;&#20010;&#21253;&#20250;&#24456;&#22823;&#65292;&#22240;&#27492;&#20250;&#34987;
    </p>
    <p>
      &#20998;&#21106;&#25104;&#19968;&#20123;&#23567;&#30340;fragment&#36827;&#34892;&#20256;&#36755;&#12290;&#31532;&#19968;&#20010;fragment&#20250;&#21253;&#21547;
    </p>
    <p>
      &#36825;&#20010;&#21253;&#30340;&#21253;&#22836;&#21363;&#20256;&#36755;&#30340;&#21327;&#35758;&#65292;&#20294;&#26159;&#20174;&#31532;&#20108;&#20010;fragment&#24320;&#22987;&#23601;
    </p>
    <p>
      &#19981;&#20250;&#21253;&#21547;&#36825;&#26679;&#30340;head&#20102;&#12290;&#35201;&#30693;&#36947;filtering rule&#26159;&#26681;&#25454;&#21253;&#22836;&#30340;&#20449;&#24687;
    </p>
    <p>
      &#26469;&#36827;&#34892;&#21305;&#37197;&#30340;&#65292;&#25152;&#20197;&#31532;&#20108;&#20010;&#20197;&#21518;&#30340;fragment&#23601;&#19981;&#20250;&#34987;filterring rule
    </p>
    <p>
      &#36827;&#34892;&#22788;&#29702;&#12290;
    </p>
    <p>
      &#20294;&#26159;&#65292;&#25105;&#20204;&#21487;&#20197;&#23545;fragment&#36827;&#34892;&#29305;&#21035;&#30340;&#22788;&#29702;&#65292;&#36890;&#36807;&#20351;&#29992;
    </p>
    <p>
      '-f'(or '--fragment') &#23601;&#21487;&#20197;&#23454;&#29616;&#12290;
    </p>
    <p>
      # iptables -A OUTPUT -f -d 192.168.1.1 -j DROP
    </p>
    <p>
      &#19978;&#38754;&#30340;&#20363;&#23376;&#23558;&#20250;drop&#20219;&#20309;&#21069;&#24448;192.168.1.1&#30340;fragment&#12290;
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474034944813" ID="ID_94133029" MODIFIED="1474035623803">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#b50909"><i>5.iptables&#30340;&#25193;&#23637;: New Matches</i></font>
    </p>
    <p>
      iptables&#26159;&#21487;&#25193;&#23637;&#30340;&#65292;&#20869;&#26680;&#36319;iptables&#24037;&#20855;&#37117;&#26159;
    </p>
    <p>
      &#21487;&#20197;&#25193;&#23637;&#26032;&#30340;&#29305;&#24615;&#30340;&#12290;
    </p>
    <p>
      &#25193;&#23637;&#26159;&#36890;&#36807;&#20004;&#31181;&#26041;&#24335;&#23454;&#29616;&#30340;: new targets, new matches
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474035627136" ID="ID_215289436" MODIFIED="1474114802490">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#cc0a0a"><i>6.TCP&#25193;&#23637; </i></font>
    </p>
    <p>
      &#22914;&#26524;&#25351;&#23450;&#20102; -p tcp&#36873;&#39033;&#65292;&#37027;&#20040;tcp&#25193;&#23637;&#20250;&#34987;&#33258;&#21160;&#22320;&#21152;&#36733;&#36827;&#21435;
    </p>
    <p>
      &#35813;&#25193;&#23637;&#20250;&#25552;&#20379;&#19979;&#38754;&#30340;&#21487;&#36873;&#39033;:
    </p>
    <p>
      --tcp-flags
    </p>
    <p>
      &#35813;&#36873;&#39033;&#21518;&#38754;&#20250;&#36319;&#20004;&#20010;&#23383;&#31526;&#20018;&#30340;&#26631;&#24535;&#65292;&#20801;&#35768;&#20320;&#36807;&#28388;&#20855;&#20307;&#30340;tcp
    </p>
    <p>
      &#21253;&#12290;&#31532;&#19968;&#20010;&#23383;&#31526;&#20018;&#26631;&#24535;&#26159;&#20010;&#25513;&#30721;&#65292;&#34920;&#31034;&#24076;&#26395;&#27979;&#35797;&#30340;flag,
    </p>
    <p>
      &#31532;&#20108;&#20010;&#23383;&#31526;&#20018;&#26631;&#24535;&#25351;&#23450;&#21738;&#19968;&#31181;tcp&#21253;&#20250;&#34987;&#35774;&#32622;&#12290;
    </p>
    <p>
      &#20030;&#20363;&#22914;&#19979;:
    </p>
    <p>
      # iptables -A INPUT --protocol tcp --tcp-flags ALL SYN,ACK -j DROP
    </p>
    <p>
      --syn
    </p>
    <p>
      &#35813;&#36873;&#39033;&#21069;&#38754;&#21487;&#36873;&#22320;&#21487;&#20197;&#28155;&#21152;&#19968;&#20010;'!'&#31526;&#21495;&#65292;
    </p>
    <p>
      &#35813;&#36873;&#39033;&#31561;&#21516;&#20110;:<font color="#226927">--tcp-flags SYN,RST,ACK SYN </font>
    </p>
    <p>
      --source-port
    </p>
    <p>
      &#35813;&#36873;&#39033;&#21518;&#36319;&#30528;&#19968;&#20010;port&#25110;&#32773;&#22810;&#20010;port
    </p>
    <p>
      --sport
    </p>
    <p>
      &#35813;&#36873;&#39033;&#36319;source-port&#30340;&#36873;&#39033;&#26159;&#19968;&#33268;&#30340;
    </p>
    <p>
      --destination-port
    </p>
    <p>
      --dport
    </p>
    <p>
      --tcp-option
    </p>
    <p>
      &#35813;&#36873;&#39033;&#21487;&#36873;&#22320;&#21487;&#20197;&#28155;&#21152;&#19968;&#20010;'!'&#31526;&#21495;&#65292;&#35813;&#36873;&#39033;&#21518;&#38754;&#36319;&#30528;&#19968;&#20010;&#25968;&#23383;&#65292;&#35813;&#25968;&#23383;
    </p>
    <p>
      &#21305;&#37197;&#24102;&#26377;tcp option&#30340;&#21253;&#65292;&#22914;&#26524;&#19968;&#20010;&#21253;&#27809;&#26377;&#23436;&#25972;&#30340;tcp&#22836;&#65292;&#37027;&#20040;&#35813;&#21253;&#23601;&#20250;
    </p>
    <p>
      &#34987;&#20002;&#24323;
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474114939433" ID="ID_875800881" MODIFIED="1474115257383">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#f20d0d"><i>7.&#20854;&#23427;&#30340;&#21305;&#37197;&#25193;&#23637; </i></font>
    </p>
    <p>
      &#20854;&#20182;&#30340;&#21305;&#37197;&#25193;&#23637;&#21487;&#20197;&#36890;&#36807;-m&#36873;&#39033;&#34987;&#21551;&#21160;&#12290;
    </p>
  </body>
</html>
</richcontent>
<node CREATED="1474115261414" ID="ID_1757266884" MODIFIED="1474115369695">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      '-m mac'&#25110;&#32773;'--match mac'&#34987;&#29992;&#26469;&#21305;&#37197;&#36827;&#20837;&#30340;&#21253;&#30340;
    </p>
    <p>
      &#28304;mac&#22320;&#22336;&#65292;&#35813;&#27169;&#22359;&#21482;&#25552;&#20379;&#19968;&#20010;&#36873;&#39033;:
    </p>
    <p>
      --mac-source 00:60:08:91:CC:B7
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474115375166" ID="ID_821511066" MODIFIED="1474116672846">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      '-m limit'&#25110;&#32773;'--match limit'&#34987;&#29992;&#26469;&#38480;&#21046;&#21305;&#37197;&#30340;&#36895;&#29575;
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474116676997" ID="ID_1504842153" MODIFIED="1474116905893">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      -m state&#36873;&#39033;&#65292;&#35813;&#36873;&#39033;&#20250;&#26377;--state&#21442;&#25968;&#65292;&#29992;&#26469;
    </p>
    <p>
      &#21305;&#37197;&#21253;&#30340;&#24403;&#21069;&#29366;&#24577;
    </p>
    <p>
      NEW&#21019;&#24314;&#20102;&#26032;&#30340;&#36830;&#25509;&#30340;&#21253;
    </p>
    <p>
      ESTABLISHED&#24050;&#32463;&#24314;&#31435;&#36215;&#36830;&#25509;&#30340;&#21253;
    </p>
    <p>
      RELATED&#35813;&#21253;&#36319;&#26576;&#20010;&#36830;&#25509;&#26377;&#20851;&#65292;&#20294;&#26159;&#19981;&#23646;&#20110;&#35813;&#36830;&#25509;
    </p>
    <p>
      INVALID&#26410;&#30693;&#38169;&#35823;&#30340;&#21253;&#65292;&#36825;&#20123;&#21253;&#20250;&#34987;&#20002;&#24323;
    </p>
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node CREATED="1474116996019" FOLDED="true" ID="ID_1586891706" MODIFIED="1474121978871">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#ec0707"><b>3.Target Specification</b></font>
    </p>
    <p>
      target&#26159;&#25351;&#23545;&#26576;&#20010;&#24050;&#32463;&#21305;&#37197;&#19978;&#30340;&#21253;&#25152;&#20570;&#30340;&#22788;&#29702;&#12290;
    </p>
    <p>
      &#24050;&#32463;&#26377;&#20004;&#20010;&#20869;&#23884;&#30340;target&#20102;: DROP&#21644;ACCEPT
    </p>
    <p>
      &#36824;&#26377;&#20004;&#20010;&#19981;&#26159;&#20869;&#23884;&#23450;&#20041;&#30340;target,
    </p>
    <p>
      extensions and user-defined chains
    </p>
  </body>
</html>
</richcontent>
<node CREATED="1474117494759" ID="ID_259143962" MODIFIED="1474120256198">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#e30303">user defined chains</font>
    </p>
    <p>
      &#24403;&#19968;&#20010;packet&#21305;&#37197;&#20102;&#26576;&#20010;rule,&#19988;&#35813;rule&#30340;target&#27491;&#26159;
    </p>
    <p>
      &#29992;&#25143;&#33258;&#23450;&#20041;&#30340;chain,&#37027;&#20040;&#35813;packet&#20250;&#34987;&#20132;&#32473;&#35813;chain&#37324;&#38754;
    </p>
    <p>
      &#30340;rule&#36827;&#34892;&#22788;&#29702;&#12290;&#22914;&#26524;&#29992;&#25143;&#33258;&#23450;&#20041;&#30340;chain&#24403;&#20013;&#30340;&#25152;&#26377;&#30340;rule
    </p>
    <p>
      &#37117;&#27809;&#26377;&#20915;&#23450;&#35813;packet&#30340;&#26368;&#32456;&#30340;&#21629;&#36816;&#65292;&#37027;&#20040;&#35813;packet&#22312;&#34987;&#25152;&#26377;
    </p>
    <p>
      &#30340;rule&#25195;&#25551;&#23436;&#20043;&#21518;&#65292;&#20250;&#36820;&#22238;&#19978;&#19968;&#23618;&#30340;chain&#24403;&#20013;&#34987;&#32487;&#32493;&#25195;&#25551;&#12290;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;v&#160;&#160;&#160;&#160;__________________________
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;`INPUT'&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|&#160;&#160;&#160;/&#160;&#160;&#160;&#160;`test'&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;v
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;------------------------|--/&#160;&#160;&#160;&#160;-----------------------|----
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;| Rule1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;| /|&#160;&#160;&#160;&#160;| Rule1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|&#160;&#160;&#160;|
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|-----------------------|/-|&#160;&#160;&#160;&#160;|----------------------|---|
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;| Rule2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/&#160;&#160;|&#160;&#160;&#160;&#160;| Rule2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|&#160;&#160;&#160;|
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|--------------------------|&#160;&#160;&#160;&#160;-----------------------v----
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;| Rule3&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/--+___________________________/
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;------------------------|---
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;v
    </p>
    <p>
      <font color="#325746">&#19968;&#20010;&#20301;&#20110;&#29992;&#25143;&#33258;&#23450;&#20041;chain&#24403;&#20013;&#30340;packet&#65292;&#21516;&#26679;&#21487;&#20197;&#36339;&#21040;&#21478;&#19968;&#20010; </font>
    </p>
    <p>
      <font color="#325746">&#29992;&#25143;&#33258;&#23450;&#20041;&#30340;chain&#24403;&#20013;&#21435;&#12290;</font>
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474117519878" ID="ID_1100440959" MODIFIED="1474119450443">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Extensions to iptables: New Targets
    </p>
    <p>
      &#19968;&#20010;target extension&#30001;&#19968;&#20010;&#20869;&#26680;&#27169;&#22359;&#21644;&#21487;&#36873;&#30340;iptables&#30340;&#25193;&#23637;
    </p>
    <p>
      &#25152;&#32452;&#25104;&#65292;&#35813;&#25193;&#23637;&#21487;&#20197;&#25552;&#20379;&#26032;&#30340;&#21629;&#20196;&#34892;&#30340;&#36873;&#39033;&#12290;&#40664;&#35748;&#30340;netfilter
    </p>
    <p>
      &#20998;&#21457;&#29256;&#26412;&#24403;&#20013;&#26377;&#19968;&#20123;&#25193;&#23637;&#36873;&#39033;&#12290;
    </p>
    <p>
      LOG: &#35813;&#27169;&#22359;&#25552;&#20379;&#23545;&#21305;&#37197;&#30340;&#21253;&#30340;&#20869;&#26680;&#26085;&#24535;
    </p>
    <p>
      REJECT:&#35813;&#27169;&#22359;&#21644;DROP&#26377;&#30456;&#21516;&#30340;&#25928;&#26524;&#65292;
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474119464129" ID="ID_1867165293" MODIFIED="1474119677970">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#de0000">&#29305;&#27530;&#30340;&#20869;&#24314;&#30340;target</font>
    </p>
    <p>
      &#26377;&#20004;&#20010;&#29305;&#27530;&#30340;&#20869;&#24314;&#30340;target,
    </p>
    <p>
      RETURN&#21644;QUEUE
    </p>
  </body>
</html>
</richcontent>
<node CREATED="1474120352666" ID="ID_371387438" MODIFIED="1474120444615">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#30446;&#26631;RETURN&#30340;&#25928;&#26524;&#30456;&#24403;&#20110;&#35813;packet&#36816;&#21160;
    </p>
    <p>
      &#21040;&#20102;&#19968;&#20010;chain&#30340;&#26411;&#23614;&#12290;&#23545;&#20110;&#20869;&#24314;&#30340;chain,
    </p>
    <p>
      &#20250;&#23545;&#35813;packet&#25191;&#34892;&#35813;chain&#40664;&#35748;&#30340;&#31574;&#30053;&#65307;
    </p>
    <p>
      &#23545;&#20110;&#29992;&#25143;&#33258;&#23450;&#20041;&#30340;chain&#65292;&#21017;&#20250;&#36820;&#22238;&#21040;&#19978;&#19968;&#23618;&#30340;
    </p>
    <p>
      chain&#24403;&#20013;&#32487;&#32493;&#25195;&#25551;&#12290;
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474121501338" ID="ID_70479536" MODIFIED="1474121953922">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      QUEUE&#26159;&#19968;&#20010;&#29305;&#27530;&#30340;target,&#29992;&#20110;&#23558;packet&#25490;&#21015;
    </p>
    <p>
      &#36827;&#20837;&#38431;&#21015;&#31561;&#24453;&#29992;&#25143;&#31354;&#38388;&#30340;&#22788;&#29702;&#12290;&#35201;&#23454;&#29616;&#36825;&#31181;&#21151;&#33021;&#65292;&#20004;&#20010;
    </p>
    <p>
      &#32452;&#20214;&#26159;&#24517;&#39035;&#30340;:
    </p>
    <p>
      &#19968;&#20010;&#26159;&quot;queue handler&quot;&#29992;&#20110;&#22788;&#29702;&#23558;packet&#22312;&#20869;&#26680;&#36319;&#29992;&#25143;
    </p>
    <p>
      &#31354;&#38388;&#20043;&#38388;&#36827;&#34892;&#20256;&#36882;&#30340;&#26426;&#21046;&#65307;&#21478;&#19968;&#20010;&#26159;&#29992;&#25143;&#31354;&#38388;&#30340;&#24212;&#29992;&#31243;&#24207;&#65292;
    </p>
    <p>
      &#29992;&#20110;&#23545;&#25509;&#25910;&#21040;&#30340;packet&#36827;&#34892;&#22788;&#29702;&#12290;
    </p>
    <p>
      &#23545;&#20110;ipv4&#30340;iptables&#26469;&#35828;&#65292;&#19968;&#20010;&#26631;&#20934;&#30340;'queue handler'&#26159;
    </p>
    <p>
      ip_queue module&#12290;&#29992;&#27861;&#22914;&#19979;:
    </p>
    <p>
      <font color="#d80f0f"># modprobe iptable_filter </font>
    </p>
    <p>
      <font color="#d80f0f"># modprobe ip_queue </font>
    </p>
    <p>
      <font color="#d80f0f"># iptables -A OUTPUT -p icmp -j QUEUE </font>
    </p>
    <p>
      &#29992;&#25143;&#31354;&#38388;&#30340;&#24212;&#29992;&#31243;&#24207;&#21487;&#20197;&#20351;&#29992; libipq API&#26469;&#36827;&#34892;&#32534;&#20889;&#12290;
    </p>
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node CREATED="1474121982838" ID="ID_432113539" MODIFIED="1474122051695">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#ef0c0c"><i>4.&#23545;&#20110;&#25972;&#20010;chain&#30340;&#25805;&#20316;</i></font>
    </p>
  </body>
</html>
</richcontent>
<node CREATED="1474122085181" ID="ID_1849322194" MODIFIED="1474122320217">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#21019;&#24314;&#19968;&#20010;&#26032;&#30340;chain
    </p>
    <p>
      iptables -N test
    </p>
    <p>
      &#21024;&#38500;&#19968;&#20010;chain
    </p>
    <p>
      # iptables -X test
    </p>
    <p>
      &#28165;&#31354;&#19968;&#20010;chain
    </p>
    <p>
      # iptables -F FORWARD
    </p>
    <p>
      &#23545;&#19968;&#20010;chain&#36827;&#34892;&#21015;&#20030;
    </p>
    <p>
      &#20320;&#21487;&#20197;&#21015;&#20030;&#20986;&#19968;&#20010;chain&#37324;&#38754;&#30340;&#25152;&#26377;&#30340;rule
    </p>
    <p>
      &#21487;&#20197;&#20351;&#29992;'-L'&#25110;&#32773;&#26159;'--list'&#21442;&#25968;&#36827;&#34892;&#21015;&#20030;
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474122337235" ID="ID_876829001" MODIFIED="1474123172943">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#35774;&#32622;&#19968;&#20010;chain&#30340;&#31574;&#30053;&#65292;&#27880;&#24847;&#65292;&#21482;&#26377;&#20869;&#24314;&#30340;chain
    </p>
    <p>
      &#25165;&#21487;&#20197;&#35774;&#32622;&#31574;&#30053;
    </p>
    <p>
      <font color="#d90e0e"><i>iptables -P FORWARD DROP</i></font>
    </p>
  </body>
</html>
</richcontent>
</node>
</node>
</node>
</node>
</node>
</node>
</map>
